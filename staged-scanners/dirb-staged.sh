#!/bin/bash

set -e
set -o pipefail
IFS=$'\n\t'

if [ $# -ne 2 ]; then
    echo "[!] Usage: dirb-staged <target> <port>"
    exit 1
fi

target=$1
port=$2

echo '[+] Beginning recursive SecLists common scan'
echo "[*] dirb ${target}:${port} /usr/share/seclists/Discovery/Web_Content/common.txt -o dirb-${port}-seclists_common.txt"
dirb ${target}:${port} /usr/share/seclists/Discovery/Web_Content/common.txt -o dirb-${port}-seclists_common.txt
echo '[*] SecLists common scan completed'

echo '[+] Beginning recursive SecLists big scan (with extensions)'
echo "[*] dirb ${target}:${port} /usr/share/seclists/Discovery/Web_Content/big.txt -o dirb-${port}-seclists_big.txt -X ,.php,.asp,.txt,.py,.pl,.cgi"
dirb ${target}:${port} /usr/share/seclists/Discovery/Web_Content/big.txt -o dirb-${port}-seclists_big.txt -X ,.php,.asp,.txt,.py,.pl,.cgi
echo '[*] SecLists big scan completed'
