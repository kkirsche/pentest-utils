#!/bin/bash

if [ -z $1 ]; then
	echo '[!] Usage: ./http-enumerator <target>'
	exit 1
fi

target=$1

httpenum='01-http-enum'
if ! [ -f ${httpenum}.nmap ]; then
  echo "[+] Beginning nmap HTTP(S) script enumeration against ${target}"
  nmap -sS -T4 -p80,443,8080 --script http-vuln*,http-webdav-scan,http-methods,http-date,http-cookie-flags,http-adobe-coldfusion-apsa1301,http-apache-server-status,http-shellshock,http-sitemap-generator,http-php-version,http-robots.txt,http-server-header,http-security-headers,http-title,http-waf*,http-favicon,http-enum -oA ${httpenum} --stats-every 60s ${target}
else
  echo "[+] nmap HTTP(S) enumeration seems to already exist. Skipping..."
fi

niktoenum='02-nikto-enum-80'
if ! [ -f ${niktoenum}.txt ]; then
  echo "[+] Beginning nikto HTTP enumeration against ${target}"
  nikto -host ${target} -port 80 -Format txt -output ${niktoenum}.txt
else
  echo "[+] nikto HTTP enumeration seems to already exist. Skipping..."
fi

niktoenum='03-nikto-enum-443'
if ! [ -f ${niktoenum}.txt ]; then
  echo "[+] Beginning nikto HTTPS enumeration against ${target}"
  nikto -host ${target} -port 443 -ssl -Format txt -output ${niktoenum}.txt
else
  echo "[+] nikto HTTPS enumeration seems to already exist. Skipping..."
fi
