#!/bin/bash

set -e
set -x
set -o pipefail
IFS=$'\n\t'

if [ -z "$1" ]; then
	echo '[!] Usage: ./ftp-enumerator <target>'
	exit 1
fi

target="$1"

ftpenum='01-ftp-enum'
if ! [ -f "${ftpenum}.nmap" ]; then
  echo "[+] Beginning nmap FTP script enumeration against ${target}"
  nmap -sS -T4 -p21 --script ftp-anon,ftp-bounce,ftp-libopie,ftp-proftpd-backdoor,ftp-syst,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221 -oA "${ftpenum}" --stats-every 60s "${target}"
else
  echo "[+] nmap FTP enumeration seems to already exist. Skipping..."
fi
