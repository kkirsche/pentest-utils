#!/bin/bash

if [ -z "$1" ]; then
	echo '[!] Usage: ./nmap-staged.sh <target>'
	exit 1
fi

target="$1"

showmount-output='01-showmount'
if ! [ -f "${showmount-output}" ]; then
	echo "[+] Beginning showmount scan against ${target}"
	showmount -e "${target}" |& tee "${showmount-output}"
else
	echo "[+] showmount scan seems to already exist. Skipping..."
fi

nfsnmap='02-nfs-nmap'
if ! [ -f "${nfsnmap}" ]; then
	echo "[+] Beginning nmap scripts against ${target}"
	nmap -sS -sV -p 111 --script nfs-statfs,nfs-showmount,nfs-ls -oA "${nfsnmap}" "${target}"

else
	echo "[+] nfs nmap scan seems to already exist. Skipping..."
fi
