#!/bin/bash

if [ -z $1 ]; then
	echo '[!] Usage: ./cups-enumerator <target>'
	exit 1
fi

target=$1

cupsenum='01-cups-enum'
if ! [ -f ${cupsenum}.nmap ]; then
  echo "[+] Beginning nmap CUPS script enumeration against ${target}"
  nmap -sS -T4 -p631 --script cups-info,cups-queue-info -oA ${cupsenum} --stats-every 60s ${target}
else
  echo "[+] nmap CUPS enumeration seems to already exist. Skipping..."
fi
